machine:
  pre:
    - wget https://github.com/google/protobuf/releases/download/v3.1.0/protoc-3.1.0-linux-x86_64.zip
    - unzip protoc-3.1.0-linux-x86_64.zip -d protoc
  environment:
      # GOROOT is not set by default
      GOROOT: ""
      PATH: "/usr/local/go/bin:/usr/local/go_workspace/bin:~/.go_workspace/bin:~/protoc/bin:${PATH}"
      GOPATH: "${HOME}/.go_workspace:/usr/local/go_workspace:${HOME}/.go_project"

dependencies:
  post:
    - go get -u github.com/golang/protobuf/{proto,protoc-gen-go}

compile:
  override:
    - make build

test:
  override:
    - make lint
    - make test
